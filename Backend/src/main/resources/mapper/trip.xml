<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.enjoytrip.trip.model.mapper.TripMapper">

    <resultMap id = "trip" type = "tripDto">
        <result column="trip_id" property="tripId"></result>
        <result column="trip_name" property="tripName"></result>
        <result column="start_date" property="startDate"></result>
        <result column="end_date" property="endDate"></result>
        <result column="member_id" property="memberId"></result>
        <result column="start_station_id" property="startStationId"></result>
        <result column="end_station_id" property="endStationId"></result>

    </resultMap>


    <update id = "insertTrip" parameterType="tripDto">
        insert into trip (trip_name, start_date, end_date, member_id,start_station_id, end_station_id)
        values(#{tripName},#{startDate},#{endDate},#{memberId},#{startStationId},#{endStationId});
    </update>

    <select id = "getLastInsertedId" resultType="Integer" >
        select last_insert_id();
    </select>

    <select id ="findTripById" parameterType="int" resultMap="trip">

    select trip_id, trip_name, start_date, end_date, member_id,start_station_id, end_station_id
    from trip
    where trip_id = #{tripId}
    </select>

    <select id = "findTripByMemberId" parameterType = "string" resultMap="trip">
    select trip_id, trip_name, start_date, end_date, member_id,start_station_id, end_station_id
    from trip
    where member_id = #{memberId}
    </select>

    <insert id = "insertTripStation" parameterType = "list">
        insert into trip_station (trip_id, station_id, start_date,end_date)
        values
        <foreach collection="list" item="item" separator=",">
            (
            #{item.tripId},
            #{item.stationId},
            #{item.startDate},
            #{item.endDate}
            )
        </foreach>

    </insert>



</mapper>