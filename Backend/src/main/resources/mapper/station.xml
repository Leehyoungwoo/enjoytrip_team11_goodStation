<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.enjoytrip.station.model.mapper.StationMapper">

    <resultMap id="stationAndSido" type="stationAndSidoDto">
        <result column="station_id" property="stationId"></result>
        <result column="station_name" property="stationName"></result>
        <result column="sido_code" property="sidoCode"></result>
        <result column="sido_name" property="sidoName"></result>
    </resultMap>


    <resultMap id="stationTourSpot" type="stationTourSpotDto">
        <result column="content_id" property="contentId"></result>
        <result column="title" property="title"></result>
        <result column="station_id" property="stationId"></result>
        <result column="longitude" property="longitude"></result>
        <result column="latitude" property="latitude"></result>
        <result column="addr1" property="address"></result>

    </resultMap>


    <!-- 모든 기차역&시도 조회-->
    <select id = "selectStations" resultMap="stationAndSido">
        select a.station_id station_id, a.name station_name, a.sido_code sido_code, b.sido_name sido_name
        from station_info a,
             sido b
        where a.sido_code = b.sido_code;
    </select>

    <!-- 시별로 기차역 조회 -->
    <select id = "selectStationsBySidoCode" parameterType = "int" resultMap="stationAndSido">
        select a.station_id station_id, a.name station_name, a.sido_code sido_code, b.sido_name sido_name
        from station_info a,
             sido b
        where a.sido_code = b.sido_code and a.sido_code = #{sidoCode}
    </select>

    <!-- 역근처 관광지 조회하기 -->
    <select id = "selectAttractionNearStation" parameterType = "string" resultMap = "stationTourSpot">
        select a.content_id content_id, b.title title, a.station_id station_id, b.longitude, b.latitude, b.addr1
        from station_tour_spot a, attraction_info b
        where a.content_id = b.content_id  and a.station_id = #{stationId} and b.content_type_id = 12;
    </select>


</mapper>